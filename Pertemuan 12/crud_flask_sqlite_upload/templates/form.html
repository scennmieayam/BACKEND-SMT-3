<!DOCTYPE html>
<html>
<head>
    <title>Form Edit Barang</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">
    <h2>{{ 'Edit Barang' if barang else 'Tambah Barang' }}</h2>
    <form method="POST" enctype="multipart/form-data">
        <div class="mb-3">
            <label>Kode Barang</label>
            <input type="text" name="kode" class="form-control" value="{{ barang[1] if barang }}" required>
        </div>
        <div class="mb-3">
            <label>Nama Barang</label>
            <input type="text" name="nama" class="form-control" value="{{ barang[2] if barang }}" required>
        </div>
        <div class="mb-3">
            <label>Harga Barang</label>
            <input type="number" name="harga" class="form-control" value="{{ barang[3] if barang }}" required>
        </div>
        <div class="mb-3">
            <label>Jumlah Unit</label>
            <input type="number" name="jumlah" class="form-control" value="{{ barang[4] if barang }}" required>
        </div>
        {% if barang %}
        <!-- FILE LAMA -->
        <div class="mb-3">
            <label>Gambar Barang</label>
            {% if barang[5] %}
            <img src="/uploads/{{ barang[5] }}" width="150">
            {% endif %}
        </div>
        <!-- PREVIEW FILE BARU -->
        <div class="mb-3">
            <label>Ganti Gambar (Opsional)</label>
            <input type="file" name="gambar" class="form-control" accept="image/*" onchange="previewImage(event)">
            <small>Preview gambar baru akan muncul di bawah</small>
            <img id="preview" class="mt-2 border" width="150" style="display:none;">
        </div>
        {% else %}
        <!-- TAMBAH DATA -->
        <div class="mb-3">
            <label>Upload Gambar</label>
            <input type="file" name="file" class="form-control" accept="image/*" required onchange="previewImage(event)">
            <img id="preview" class="mt-2 border" width="150" style="display: none;">
        </div>
        {% endif %}
        <button class="btn btn-success">Simpan</button>
        <a href="/" class="btn btn-secondary">Kembali</a>
    </form>
    <script>
        function previewImage(event) {
            const preview = document.getElementById('preview');
            const file = event.target.files[0];
            if (!file) {
                preview.style.display = 'none';
                return;
            }
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            }
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>

