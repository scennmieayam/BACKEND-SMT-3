<!doctype html>
<html lang="id">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Admin - Data Kamar Hotel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}"/>
</head>
<body>
<nav class="navbar navbar-expand-lg mb-4">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('admin_rooms') }}">Admin HOTEL CITYKOM</a>
        <div class="d-flex ms-auto">
            <a class="btn btn-light btn-sm me-2" href="{{ url_for('admin_rooms') }}">Kamar</a>
            <a class="btn btn-outline-light btn-sm me-2" href="{{ url_for('admin_banners') }}">Banner</a>
            <a class="btn btn-outline-light btn-sm me-2" href="{{ url_for('admin_tipe_kamar') }}">Detail Tipe</a>
            <a class="btn btn-outline-light btn-sm me-2" href="{{ url_for('admin_contacts') }}">Kontak</a>
            <a class="btn btn-outline-light btn-sm me-2" href="{{ url_for('admin_bookings') }}">Booking</a>
            <a class="btn btn-outline-danger btn-sm" href="{{ url_for('admin_logout') }}">Logout</a>
        </div>
    </div>
</nav>
<div class="container mb-5">
    <div class="row">
        <div class="col-lg-4 mb-4">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    {% if edit_kamar %}
                    Edit Kamar #{{ edit_kamar['id_kamar'] }}
                    {% else %}
                    Tambah Kamar
                    {% endif %}
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data" action="{% if edit_kamar %}{{ url_for('admin_edit_room', id_kamar=edit_kamar['id_kamar']) }}{% else %}{{ url_for('admin_add_room') }}{% endif %}">
                        <div class="mb-3">
                            <label class="form-label">Nomor Kamar</label>
                            <input type="text" name="nomor_kamar" class="form-control" value="{% if edit_kamar %}{{ edit_kamar['nomor_kamar'] }}{% endif %}" required/>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Tipe Kamar</label>
                            <input type="text" name="tipe_kamar" class="form-control" value="{% if edit_kamar %}{{ edit_kamar['tipe_kamar'] }}{% endif %}" required/>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Harga per Malam</label>
                            <input type="number" name="harga_per_malam" class="form-control" value="{% if edit_kamar %}{{ edit_kamar['harga_per_malam'] }}{% endif %}" required/>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Status</label>
                            <select name="status" class="form-select" required>
                                <option value="">Pilih status</option>
                                <option value="Tersedia" {% if edit_kamar and edit_kamar['status'] == 'Tersedia' %}selected{% endif %}>Tersedia</option>
                                <option value="Tidak Tersedia" {% if edit_kamar and edit_kamar['status'] == 'Tidak Tersedia' %}selected{% endif %}>Tidak Tersedia</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Deskripsi</label>
                            <textarea name="deskripsi" class="form-control" rows="3">{% if edit_kamar %}{{ edit_kamar['deskripsi'] }}{% endif %}</textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Gambar Kamar</label>
                            <input type="file" name="file" class="form-control"/>
                            {% if edit_kamar and edit_kamar['filename'] %}
                            <div class="mt-2">
                                <img src="{{ url_for('static', filename='images/kamar/' ~ edit_kamar['filename']) }}" alt="Gambar kamar" class="img-thumbnail" style="max-width: 100px"/>
                            </div>
                            {% endif %}
                        </div>
                        <div class="d-flex justify-content-between">
                            {% if edit_kamar %}
                            <a href="{{ url_for('admin_rooms') }}" class="btn btn-secondary">Batal</a>
                            <button type="submit" class="btn btn-primary">Update</button>
                            {% else %}
                            <button type="submit" class="btn btn-success">Simpan</button>
                            {% endif %}
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Daftar Kamar</h5>
                    <form method="get" class="d-flex gap-2 align-items-center" style="max-width: 300px;">
                        <input type="text" name="search" class="form-control form-control-sm" placeholder="Cari kamar..." value="{{ search|default('') }}" style="flex: 1;">
                        {% if search|default('') %}
                        <a href="{{ url_for('admin_rooms') }}" class="btn btn-outline-light btn-sm" style="flex-shrink: 0;">Ã—</a>
                        {% endif %}
                    </form>
                </div>
                <div class="card-body table-responsive">
                    {% if total|default(0) > 0 %}
                    <div class="mb-2 text-muted small">Menampilkan {{ ((page|default(1) - 1) * 10) + 1 }} - {{ [page|default(1) * 10, total|default(0)]|min }} dari {{ total|default(0) }} data</div>
                    {% endif %}
                    <table class="table table-striped align-middle mb-0">
                        <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nomor</th>
                            <th>Tipe</th>
                            <th>Harga/Malam</th>
                            <th>Status</th>
                            <th>Gambar</th>
                            <th>Aksi</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for kamar in kamar_list %}
                        <tr>
                            <td>{{ kamar['id_kamar'] }}</td>
                            <td>{{ kamar['nomor_kamar'] }}</td>
                            <td>{{ kamar['tipe_kamar'] }}</td>
                            <td>{{ kamar['harga_per_malam']|rupiah }}</td>
                            <td>
                                {% if kamar['status'] == 'Tersedia' %}
                                <span class="badge bg-success">Tersedia</span>
                                {% else %}
                                <span class="badge bg-secondary">Tidak Tersedia</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if kamar['filename'] %}
                                <img src="{{ url_for('static', filename='images/kamar/' ~ kamar['filename']) }}" alt="Gambar kamar" class="img-thumbnail" style="max-width: 80px"/>
                                {% endif %}
                            </td>
                            <td>
                                <div class="d-flex gap-2">
                                    <a href="{{ url_for('admin_edit_room', id_kamar=kamar['id_kamar']) }}" class="btn btn-sm btn-primary">Edit</a>
                                    <a href="{{ url_for('admin_delete_room', id_kamar=kamar['id_kamar']) }}" class="btn btn-sm btn-danger" onclick="return confirm('Yakin ingin menghapus kamar ini?')">Hapus</a>
                                </div>
                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="7" class="text-center">Belum ada data kamar</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% if total_pages|default(1) > 1 %}
                    <nav aria-label="Page navigation" class="mt-3">
                        <ul class="pagination justify-content-center mb-0">
                            {% if page|default(1) > 1 %}
                            <li class="page-item">
                                <a class="page-link" href="{{ url_for('admin_rooms', page=page|default(1)-1, search=search|default('')) }}">Sebelumnya</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <span class="page-link">Sebelumnya</span>
                            </li>
                            {% endif %}
                            {% for p in range(1, total_pages|default(1) + 1) %}
                            {% if p == page|default(1) %}
                            <li class="page-item active">
                                <span class="page-link">{{ p }}</span>
                            </li>
                            {% elif p <= 3 or p > total_pages|default(1) - 3 or (p >= page|default(1) - 1 and p <= page|default(1) + 1) %}
                            <li class="page-item">
                                <a class="page-link" href="{{ url_for('admin_rooms', page=p, search=search|default('')) }}">{{ p }}</a>
                            </li>
                            {% elif p == 4 or p == total_pages|default(1) - 3 %}
                            <li class="page-item disabled">
                                <span class="page-link">...</span>
                            </li>
                            {% endif %}
                            {% endfor %}
                            {% if page|default(1) < total_pages|default(1) %}
                            <li class="page-item">
                                <a class="page-link" href="{{ url_for('admin_rooms', page=page|default(1)+1, search=search|default('')) }}">Selanjutnya</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <span class="page-link">Selanjutnya</span>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>
</html>
